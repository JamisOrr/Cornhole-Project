<!doctype html>
<html>

<body>
    <input type="button" id="button" onclick="hehe()" value="connect">
    <input type="button" id="reset" onclick="reset()" value="reset">
    <h2 id="rscore">0</h2>
    <h2 id="bscore">0</h2>
    <script>

        var r = 0;
        var b = 0;
        async function hehe() {
            const port = await navigator.serial.requestPort();
            await port.open({ baudRate: 9600 });
            while (port.readable) {
                const textDecoder = new TextDecoderStream();
                const readableStreamClosed = port.readable.pipeTo(textDecoder.writable);
                const reader = textDecoder.readable.getReader();
                try {
                    while (true) {
                        const { value, done } = await reader.read();
                        if (value) {
                            console.log(value);
                            if (value == 0) {
                                r++;
                                pt();
                            }
                            if (value == 1) {
                                b++;
                                pt();
                            }
                        }
                    }
                } catch (error) {
                    console.log("errer");
                }
            }
            console.log("not readable");
            await port.close();
        }
        function pt() {
            document.getElementById("rscore").innerText = r;
            document.getElementById("bscore").innerText = b;
        }
        function reset(){
            r=0;
            b=0;
            pt();
        }

    </script>
</body>

</html>